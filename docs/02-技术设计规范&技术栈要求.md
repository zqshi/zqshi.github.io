# æŠ€æœ¯è®¾è®¡è§„èŒƒ & æŠ€æœ¯æ ˆè¦æ±‚
## Digital Employee System Technical Design Standards & Technology Stack Requirements v1.0 

### ğŸ“‹ æ–‡æ¡£ä¿¡æ¯
- **æ–‡æ¡£ç‰ˆæœ¬**: v1.0
- **åˆ›å»ºæ—¥æœŸ**: 2024-01-24  
- **é€‚ç”¨èŒƒå›´**: æ•°å­—å‘˜å·¥ç³»ç»Ÿæ‰€æœ‰æŠ€æœ¯å¼€å‘å·¥ä½œ
- **ç»´æŠ¤éƒ¨é—¨**: æŠ€æœ¯æ¶æ„å§”å‘˜ä¼š

---

## ğŸ—ï¸ æ•´ä½“æŠ€æœ¯æ¶æ„

### 1.1 ç³»ç»Ÿæ¶æ„è®¾è®¡åŸåˆ™

#### 1.1.1 æ ¸å¿ƒè®¾è®¡åŸåˆ™

| åŸåˆ™ | æè¿° | å®æ–½è¦æ±‚ |
|------|------|----------|
| **é«˜å†…èšä½è€¦åˆ** | æ¨¡å—å†…éƒ¨åŠŸèƒ½ç´§å¯†ç›¸å…³ï¼Œæ¨¡å—é—´ä¾èµ–æœ€å° | å•ä¸€èŒè´£åŸåˆ™ï¼Œæ¥å£éš”ç¦» |
| **å¯æ‰©å±•æ€§** | ç³»ç»Ÿèƒ½å¤Ÿè½»æ¾æ·»åŠ æ–°åŠŸèƒ½å’ŒAgent | æ’ä»¶åŒ–æ¶æ„ï¼Œé…ç½®é©±åŠ¨ |
| **é«˜å¯ç”¨æ€§** | ç³»ç»Ÿ7Ã—24å°æ—¶ç¨³å®šè¿è¡Œ | æ•…éšœè½¬ç§»ï¼Œè´Ÿè½½å‡è¡¡ |
| **å®‰å…¨æ€§** | å…¨æ–¹ä½å®‰å…¨é˜²æŠ¤æœºåˆ¶ | èº«ä»½è®¤è¯ï¼Œæƒé™æ§åˆ¶ï¼Œæ•°æ®åŠ å¯† |
| **å¯ç»´æŠ¤æ€§** | ä»£ç æ¸…æ™°ï¼Œæ–‡æ¡£å®Œæ•´ï¼Œæ˜“äºç»´æŠ¤ | æ ‡å‡†åŒ–å¼€å‘ï¼Œå®Œæ•´æµ‹è¯• |
| **æ€§èƒ½ä¼˜å…ˆ** | ç³»ç»Ÿå“åº”å¿«é€Ÿï¼Œèµ„æºåˆ©ç”¨é«˜æ•ˆ | å¼‚æ­¥å¤„ç†ï¼Œç¼“å­˜ç­–ç•¥ |

#### 1.1.2 æ¶æ„é£æ ¼çº¦å®š

```mermaid
graph TB
    subgraph "è¡¨ç°å±‚ Presentation Layer"
        A1[Web UI]
        A2[API Gateway]
        A3[Mobile App]
    end
    
    subgraph "ä¸šåŠ¡å±‚ Business Layer"
        B1[Agentç®¡ç†æœåŠ¡]
        B2[ä»»åŠ¡è°ƒåº¦æœåŠ¡]
        B3[Promptç®¡ç†æœåŠ¡]
        B4[ç›‘æ§æ²»ç†æœåŠ¡]
    end
    
    subgraph "æ•°æ®å±‚ Data Layer"
        C1[Agentæ³¨å†Œè¡¨]
        C2[ä»»åŠ¡é˜Ÿåˆ—]
        C3[é…ç½®ä¸­å¿ƒ]
        C4[ç›‘æ§æ•°æ®]
    end
    
    subgraph "åŸºç¡€è®¾æ–½å±‚ Infrastructure Layer"
        D1[æ¶ˆæ¯é˜Ÿåˆ—]
        D2[ç¼“å­˜é›†ç¾¤]
        D3[æ•°æ®åº“é›†ç¾¤]
        D4[æ—¥å¿—ç³»ç»Ÿ]
    end
    
    A1 --> B1
    A2 --> B2
    A3 --> B3
    B1 --> C1
    B2 --> C2
    B3 --> C3
    B4 --> C4
    C1 --> D3
    C2 --> D1
    C3 --> D2
    C4 --> D4
```

### 1.2 æŠ€æœ¯é€‰å‹æ ‡å‡†

#### 1.2.1 æŠ€æœ¯é€‰å‹è¯„ä¼°çŸ©é˜µ

| è¯„ä¼°ç»´åº¦ | æƒé‡ | è¯„åˆ†æ ‡å‡† | æœ€ä½è¦æ±‚ |
|----------|------|----------|----------|
| **æŠ€æœ¯æˆç†Ÿåº¦** | 25% | ç”Ÿäº§ç¯å¢ƒåº”ç”¨æ—¶é—´â‰¥2å¹´ | 8åˆ†ä»¥ä¸Š |
| **ç¤¾åŒºæ´»è·ƒåº¦** | 20% | GitHub starâ‰¥5Kï¼Œæ´»è·ƒè´¡çŒ®è€…â‰¥100 | 7åˆ†ä»¥ä¸Š |
| **æ€§èƒ½è¡¨ç°** | 20% | åŸºå‡†æµ‹è¯•è¾¾åˆ°è¡Œä¸šå¹³å‡æ°´å¹³ | 7åˆ†ä»¥ä¸Š |
| **å­¦ä¹ æˆæœ¬** | 15% | å›¢é˜ŸæŠ€èƒ½åŒ¹é…åº¦ | 6åˆ†ä»¥ä¸Š |
| **æ‰©å±•æ€§** | 10% | æ”¯æŒæ°´å¹³æ‰©å±•ï¼Œæ’ä»¶æœºåˆ¶ | 7åˆ†ä»¥ä¸Š |
| **ç»´æŠ¤æˆæœ¬** | 10% | æ–‡æ¡£å®Œæ•´ï¼Œå·¥å…·ç”Ÿæ€ä¸°å¯Œ | 6åˆ†ä»¥ä¸Š |

#### 1.2.2 æŠ€æœ¯é€‰å‹å†³ç­–æµç¨‹

```mermaid
flowchart TD
    A[æŠ€æœ¯éœ€æ±‚åˆ†æ] --> B[å€™é€‰æŠ€æœ¯è°ƒç ”]
    B --> C[æŠ€æœ¯è¯„ä¼°çŸ©é˜µ]
    C --> D[PoCéªŒè¯]
    D --> E{è¯„ä¼°ç»“æœ}
    E -->|é€šè¿‡| F[æŠ€æœ¯é€‰å‹å†³ç­–]
    E -->|ä¸é€šè¿‡| G[é‡æ–°é€‰å‹]
    F --> H[æŠ€æœ¯æ ‡å‡†åˆ¶å®š]
    G --> B
```

---

## ğŸ’» åç«¯æŠ€æœ¯æ ˆ

### 2.1 æ ¸å¿ƒæ¡†æ¶æŠ€æœ¯æ ˆ

#### 2.1.1 PythonæŠ€æœ¯æ ˆ (æ¨è)

```yaml
æ ¸å¿ƒæ¡†æ¶:
  webæ¡†æ¶: FastAPI 0.104+
  å¼‚æ­¥æ¡†æ¶: asyncio + uvloop
  æ•°æ®éªŒè¯: Pydantic 2.0+
  ä¾èµ–æ³¨å…¥: dependency-injector
  
æ•°æ®å±‚:
  ORMæ¡†æ¶: SQLAlchemy 2.0+ (async)
  æ•°æ®åº“é©±åŠ¨: asyncpg (PostgreSQL), aiomysql (MySQL)
  è¿ç§»å·¥å…·: Alembic
  è¿æ¥æ± : asyncpg-pool
  
ç¼“å­˜å±‚:
  Rediså®¢æˆ·ç«¯: aioredis 2.0+
  å†…å­˜ç¼“å­˜: cachetools
  åˆ†å¸ƒå¼ç¼“å­˜: Redis Cluster
  
æ¶ˆæ¯é˜Ÿåˆ—:
  å¼‚æ­¥é˜Ÿåˆ—: Celery + Redis
  å®æ—¶é€šä¿¡: WebSocket (FastAPIå†…ç½®)
  äº‹ä»¶æ€»çº¿: aio-pika (RabbitMQ)
  
ç›‘æ§è§‚æµ‹:
  æ—¥å¿—æ¡†æ¶: structlog + loguru
  æŒ‡æ ‡æ”¶é›†: prometheus-client
  é“¾è·¯è¿½è¸ª: opentelemetry
  æ€§èƒ½ç›‘æ§: py-spy
```

#### 2.1.2 æŠ€æœ¯æ ˆç‰ˆæœ¬è¦æ±‚

| ç»„ä»¶ | ç‰ˆæœ¬è¦æ±‚ | é€‰æ‹©ç†ç”± | å¤‡æ³¨ |
|------|----------|----------|------|
| **Python** | 3.11+ | æ€§èƒ½æå‡ï¼Œç±»å‹æ³¨è§£å¢å¼º | å¿…é¡»æ”¯æŒasync/await |
| **FastAPI** | 0.104+ | é«˜æ€§èƒ½ï¼Œè‡ªåŠ¨APIæ–‡æ¡£ | æ›¿ä»£Flask/Django |
| **SQLAlchemy** | 2.0+ | å¼‚æ­¥æ”¯æŒï¼Œæ€§èƒ½ä¼˜åŒ– | å¿…é¡»ä½¿ç”¨å¼‚æ­¥æ¨¡å¼ |
| **Pydantic** | 2.0+ | æ•°æ®éªŒè¯ï¼Œåºåˆ—åŒ– | ä¸FastAPIæ·±åº¦é›†æˆ |
| **Redis** | 7.0+ | æŒä¹…åŒ–ï¼Œé›†ç¾¤æ”¯æŒ | ç”¨äºç¼“å­˜å’Œé˜Ÿåˆ— |
| **PostgreSQL** | 15+ | JSONæ”¯æŒï¼Œæ€§èƒ½ä¼˜åŒ– | ä¸»æ•°æ®åº“ |

### 2.2 Agentæ ¸å¿ƒæŠ€æœ¯è§„èŒƒ

#### 2.2.1 AgentåŸºç¡€æ¶æ„æ ‡å‡†

```python
# Agentæ¥å£æ ‡å‡†å®šä¹‰
from abc import ABC, abstractmethod
from typing import Dict, List, Any, Optional
from dataclasses import dataclass
from enum import Enum
import asyncio
import uuid
from datetime import datetime

@dataclass
class AgentConfig:
    """Agenté…ç½®æ ‡å‡†"""
    agent_id: str
    agent_type: str
    version: str
    capabilities: List[str]
    max_concurrent_tasks: int = 10
    timeout_seconds: int = 300
    resource_limits: Dict[str, Any] = None
    
class TaskStatus(Enum):
    """ä»»åŠ¡çŠ¶æ€æšä¸¾æ ‡å‡†"""
    PENDING = "pending"
    RUNNING = "running" 
    COMPLETED = "completed"
    FAILED = "failed"
    CANCELLED = "cancelled"
    TIMEOUT = "timeout"

@dataclass
class TaskResult:
    """ä»»åŠ¡ç»“æœæ ‡å‡†æ ¼å¼"""
    task_id: str
    status: TaskStatus
    result: Optional[Dict[str, Any]] = None
    error: Optional[str] = None
    execution_time: float = 0.0
    resource_usage: Dict[str, Any] = None
    created_at: datetime = None
    completed_at: datetime = None

class BaseAgent(ABC):
    """AgentåŸºç¡€ç±»æ ‡å‡† v3.0"""
    
    def __init__(self, config: AgentConfig):
        self.config = config
        self.status = AgentStatus.INITIALIZING
        self.task_queue = asyncio.Queue(maxsize=config.max_concurrent_tasks)
        self.active_tasks: Dict[str, asyncio.Task] = {}
        
        # ç»Ÿä¸€ç»„ä»¶åˆå§‹åŒ–
        self._initialize_governance()
        self._initialize_monitoring()
        self._initialize_prompt_manager()
    
    @abstractmethod
    async def execute_task(self, task: Task) -> TaskResult:
        """æ‰§è¡Œä»»åŠ¡çš„æ ¸å¿ƒæ–¹æ³• - å¿…é¡»å®ç°"""
        pass
    
    def _initialize_governance(self):
        """åˆå§‹åŒ–æ²»ç†ç»„ä»¶"""
        from .governance import AgentGovernanceManager
        self.governance = AgentGovernanceManager.get_instance()
        self.governance.register_agent(self)
    
    def _initialize_monitoring(self):
        """åˆå§‹åŒ–ç›‘æ§ç»„ä»¶"""
        from .monitoring import AgentMonitor
        self.monitor = AgentMonitor(self.config.agent_id)
    
    def _initialize_prompt_manager(self):
        """åˆå§‹åŒ–Promptç®¡ç†å™¨"""
        from .prompt import UnifiedPromptManager
        self.prompt_manager = UnifiedPromptManager.get_instance()
```

#### 2.2.2 Agentç”Ÿå‘½å‘¨æœŸç®¡ç†

```python
class AgentLifecycleManager:
    """Agentç”Ÿå‘½å‘¨æœŸç®¡ç†æ ‡å‡†"""
    
    async def create_agent(self, agent_type: str, config: Dict[str, Any]) -> BaseAgent:
        """æ ‡å‡†Agentåˆ›å»ºæµç¨‹"""
        # 1. é…ç½®éªŒè¯
        validated_config = await self._validate_config(agent_type, config)
        
        # 2. ä¾èµ–æ£€æŸ¥
        await self._check_dependencies(agent_type)
        
        # 3. èµ„æºåˆ†é…
        resources = await self._allocate_resources(validated_config)
        
        # 4. Agentå®ä¾‹åŒ–
        agent = await self._instantiate_agent(agent_type, validated_config)
        
        # 5. å¥åº·æ£€æŸ¥
        await self._health_check(agent)
        
        # 6. æ³¨å†Œåˆ°ç³»ç»Ÿ
        await self._register_agent(agent)
        
        return agent
    
    async def destroy_agent(self, agent_id: str) -> bool:
        """æ ‡å‡†Agenté”€æ¯æµç¨‹"""
        # 1. åœæ­¢æ¥æ”¶æ–°ä»»åŠ¡
        await self._stop_accepting_tasks(agent_id)
        
        # 2. ç­‰å¾…ç°æœ‰ä»»åŠ¡å®Œæˆ
        await self._wait_for_tasks_completion(agent_id)
        
        # 3. æ¸…ç†èµ„æº
        await self._cleanup_resources(agent_id)
        
        # 4. æ³¨é”€Agent
        await self._unregister_agent(agent_id)
        
        return True
```

### 2.3 æ•°æ®å¤„ç†æŠ€æœ¯è§„èŒƒ

#### 2.3.1 æ•°æ®åº“è®¿é—®å±‚æ ‡å‡†

```python
# æ•°æ®è®¿é—®å±‚ç»Ÿä¸€æ¥å£
class BaseRepository(ABC):
    """æ•°æ®ä»“åº“åŸºç¡€ç±»"""
    
    def __init__(self, db_session: AsyncSession):
        self.db = db_session
    
    @abstractmethod
    async def create(self, entity: Any) -> Any:
        """åˆ›å»ºå®ä½“"""
        pass
    
    @abstractmethod
    async def get_by_id(self, entity_id: str) -> Optional[Any]:
        """æ ¹æ®IDè·å–å®ä½“"""
        pass
    
    @abstractmethod
    async def update(self, entity_id: str, data: Dict[str, Any]) -> Optional[Any]:
        """æ›´æ–°å®ä½“"""
        pass
    
    @abstractmethod
    async def delete(self, entity_id: str) -> bool:
        """åˆ é™¤å®ä½“"""
        pass
    
    async def get_by_filter(self, **filters) -> List[Any]:
        """æ ¹æ®æ¡ä»¶æŸ¥è¯¢"""
        # ç»Ÿä¸€çš„æŸ¥è¯¢å®ç°
        pass

# ä½¿ç”¨ç¤ºä¾‹
class AgentRepository(BaseRepository):
    """Agentæ•°æ®ä»“åº“"""
    
    async def create(self, agent: Agent) -> Agent:
        self.db.add(agent)
        await self.db.commit()
        await self.db.refresh(agent)
        return agent
    
    async def get_active_agents(self) -> List[Agent]:
        result = await self.db.execute(
            select(Agent).where(Agent.status == AgentStatus.ACTIVE)
        )
        return result.scalars().all()
```

#### 2.3.2 ç¼“å­˜ç­–ç•¥æ ‡å‡†

```python
class CacheManager:
    """ç»Ÿä¸€ç¼“å­˜ç®¡ç†å™¨"""
    
    def __init__(self, redis_client: aioredis.Redis):
        self.redis = redis_client
        self.default_ttl = 3600  # 1å°æ—¶
    
    async def get_or_set(self, 
                        key: str, 
                        factory: Callable,
                        ttl: int = None) -> Any:
        """ç¼“å­˜è·å–æˆ–è®¾ç½®æ¨¡å¼"""
        # 1. å°è¯•ä»ç¼“å­˜è·å–
        cached_value = await self.redis.get(key)
        if cached_value:
            return json.loads(cached_value)
        
        # 2. è°ƒç”¨å·¥å‚æ–¹æ³•è·å–æ•°æ®
        value = await factory()
        
        # 3. è®¾ç½®ç¼“å­˜
        await self.redis.setex(
            key, 
            ttl or self.default_ttl, 
            json.dumps(value, default=str)
        )
        
        return value
    
    async def invalidate_pattern(self, pattern: str):
        """æŒ‰æ¨¡å¼æ‰¹é‡åˆ é™¤ç¼“å­˜"""
        keys = await self.redis.keys(pattern)
        if keys:
            await self.redis.delete(*keys)
```

---

## ğŸ—„ï¸ æ•°æ®å±‚æŠ€æœ¯è¦æ±‚

### 3.1 æ•°æ®åº“æŠ€æœ¯æ ˆ

#### 3.1.1 ä¸»æ•°æ®åº“ - PostgreSQL

```yaml
ç‰ˆæœ¬è¦æ±‚: PostgreSQL 15+
æ‰©å±•ç»„ä»¶:
  - uuid-ossp: UUIDç”Ÿæˆ
  - pg_stat_statements: æ€§èƒ½ç›‘æ§
  - pg_trgm: å…¨æ–‡æœç´¢
  - jsonb_plpython3u: JSONå¤„ç†

è¿æ¥æ± é…ç½®:
  min_connections: 10
  max_connections: 100
  max_inactive_connection_lifetime: 300
  
æ€§èƒ½ä¼˜åŒ–:
  shared_buffers: 256MB
  effective_cache_size: 1GB
  work_mem: 16MB
  maintenance_work_mem: 256MB
```

#### 3.1.2 æ—¶åºæ•°æ®åº“ - InfluxDB

```yaml
ç‰ˆæœ¬è¦æ±‚: InfluxDB 2.0+
ç”¨é€”: Agentæ€§èƒ½æŒ‡æ ‡ï¼Œç›‘æ§æ•°æ®
é…ç½®:
  retention_policy: 30å¤©
  shard_duration: 1å¤©
  replication_factor: 2
```

#### 3.1.3 æ–‡æ¡£æ•°æ®åº“ - MongoDB (å¯é€‰)

```yaml
ç‰ˆæœ¬è¦æ±‚: MongoDB 6.0+
ç”¨é€”: Promptæ¨¡æ¿ï¼Œéç»“æ„åŒ–æ•°æ®
é…ç½®:
  replica_set: 3èŠ‚ç‚¹
  write_concern: majority
  read_preference: primaryPreferred
```

### 3.2 ç¼“å­˜æŠ€æœ¯è¦æ±‚

#### 3.2.1 Redisé›†ç¾¤é…ç½®

```yaml
ç‰ˆæœ¬è¦æ±‚: Redis 7.0+
éƒ¨ç½²æ¨¡å¼: Redis Cluster (3ä¸»3ä»)
é…ç½®å‚æ•°:
  maxmemory: 2GB
  maxmemory-policy: allkeys-lru
  save: "900 1 300 10 60 10000"
  appendonly: yes
  appendfsync: everysec
```

#### 3.2.2 ç¼“å­˜åˆ†å±‚ç­–ç•¥

```mermaid
graph TB
    A[åº”ç”¨è¯·æ±‚] --> B{L1ç¼“å­˜}
    B -->|å‘½ä¸­| C[å†…å­˜ç¼“å­˜è¿”å›]
    B -->|æœªå‘½ä¸­| D{L2ç¼“å­˜}
    D -->|å‘½ä¸­| E[Redisè¿”å›]
    D -->|æœªå‘½ä¸­| F[æ•°æ®åº“æŸ¥è¯¢]
    F --> G[æ›´æ–°ç¼“å­˜]
    G --> H[è¿”å›ç»“æœ]
```

---

## ğŸ” å®‰å…¨æŠ€æœ¯è¦æ±‚

### 4.1 èº«ä»½è®¤è¯ä¸æˆæƒ

#### 4.1.1 è®¤è¯æŠ€æœ¯æ ˆ

```yaml
è®¤è¯åè®®: OAuth 2.0 + JWT
JWTé…ç½®:
  algorithm: RS256
  expiration: 15åˆ†é’Ÿ (access_token)
  refresh_expiration: 7å¤© (refresh_token)
  issuer: digital-employee-system
  
å¯†ç å®‰å…¨:
  hash_algorithm: bcrypt
  salt_rounds: 12
  min_password_length: 8
  password_complexity: å¿…é¡»åŒ…å«å¤§å°å†™å­—æ¯ã€æ•°å­—ã€ç‰¹æ®Šå­—ç¬¦
```

#### 4.1.2 æƒé™æ§åˆ¶æ¨¡å‹

```python
# RBACæƒé™æ¨¡å‹å®ç°
class Permission(BaseModel):
    """æƒé™å®šä¹‰"""
    resource: str  # èµ„æºç±»å‹ï¼Œå¦‚ 'agent', 'task', 'prompt'
    action: str    # æ“ä½œç±»å‹ï¼Œå¦‚ 'create', 'read', 'update', 'delete'
    conditions: Dict[str, Any] = {}  # æ¡ä»¶é™åˆ¶

class Role(BaseModel):
    """è§’è‰²å®šä¹‰"""
    role_id: str
    role_name: str
    permissions: List[Permission]
    
class User(BaseModel):
    """ç”¨æˆ·å®šä¹‰"""
    user_id: str
    username: str
    roles: List[str]  # è§’è‰²IDåˆ—è¡¨

@contextmanager  
async def require_permission(resource: str, action: str):
    """æƒé™æ£€æŸ¥è£…é¥°å™¨"""
    current_user = get_current_user()
    if not await check_permission(current_user, resource, action):
        raise HTTPException(status_code=403, detail="æƒé™ä¸è¶³")
    yield
```

### 4.2 æ•°æ®å®‰å…¨

#### 4.2.1 æ•°æ®åŠ å¯†æ ‡å‡†

```yaml
ä¼ è¾“åŠ å¯†:
  protocol: TLS 1.3
  cipher_suites: AEAD (AES-GCM, ChaCha20-Poly1305)
  key_exchange: ECDHE
  
å­˜å‚¨åŠ å¯†:
  algorithm: AES-256-GCM
  key_management: HashiCorp Vault
  key_rotation: 90å¤©
  
æ•æ„Ÿæ•°æ®å¤„ç†:
  PIIæ•°æ®: å¿…é¡»åŠ å¯†å­˜å‚¨
  å¯†ç : bcryptå“ˆå¸Œ
  APIå¯†é’¥: åŠ å¯†å­˜å‚¨ï¼Œé™åˆ¶è®¿é—®æƒé™
```

#### 4.2.2 å®‰å…¨å®¡è®¡

```python
class SecurityAuditLogger:
    """å®‰å…¨å®¡è®¡æ—¥å¿—"""
    
    async def log_authentication(self, user_id: str, action: str, result: str):
        """è®°å½•è®¤è¯äº‹ä»¶"""
        await self._log_security_event({
            "event_type": "authentication",
            "user_id": user_id,
            "action": action,
            "result": result,
            "timestamp": datetime.utcnow(),
            "ip_address": get_client_ip(),
            "user_agent": get_user_agent()
        })
    
    async def log_authorization(self, user_id: str, resource: str, action: str, result: str):
        """è®°å½•æˆæƒäº‹ä»¶"""
        await self._log_security_event({
            "event_type": "authorization", 
            "user_id": user_id,
            "resource": resource,
            "action": action,
            "result": result,
            "timestamp": datetime.utcnow()
        })
```

---

## ğŸ“Š ç›‘æ§ä¸å¯è§‚æµ‹æ€§

### 5.1 ç›‘æ§æŠ€æœ¯æ ˆ

#### 5.1.1 æŒ‡æ ‡ç›‘æ§ - Prometheus + Grafana

```yaml
Prometheusé…ç½®:
  version: 2.40+
  scrape_interval: 15s
  evaluation_interval: 15s
  retention: 15å¤©
  storage: æœ¬åœ°å­˜å‚¨ + è¿œç¨‹å­˜å‚¨(å¯é€‰)

Grafanaé…ç½®:  
  version: 9.0+
  datasources: Prometheus, InfluxDB, Elasticsearch
  dashboards: Agentæ€§èƒ½ã€ç³»ç»Ÿèµ„æºã€ä¸šåŠ¡æŒ‡æ ‡
  alerting: åŸºäºé˜ˆå€¼å’Œå¼‚å¸¸æ£€æµ‹
```

#### 5.1.2 æ—¥å¿—ç›‘æ§ - ELK Stack

```yaml
Elasticsearch:
  version: 8.0+
  nodes: 3èŠ‚ç‚¹é›†ç¾¤
  indices: æŒ‰æ—¥æœŸåˆ†ç‰‡ï¼Œ7å¤©è½®è½¬

Logstash:
  version: 8.0+
  inputs: filebeat, http, redis
  filters: grok, mutate, date
  outputs: elasticsearch

Kibana:
  version: 8.0+
  dashboards: æ—¥å¿—åˆ†æï¼Œé”™è¯¯è¿½è¸ª
  alerting: å¼‚å¸¸æ—¥å¿—å‘Šè­¦
```

#### 5.1.3 é“¾è·¯è¿½è¸ª - Jaeger

```yaml
ç‰ˆæœ¬è¦æ±‚: Jaeger 1.40+
éƒ¨ç½²æ¨¡å¼: All-in-one (å¼€å‘) / Production (ç”Ÿäº§)
é‡‡æ ·ç­–ç•¥: 
  - é”™è¯¯è¯·æ±‚: 100%é‡‡æ ·
  - æ­£å¸¸è¯·æ±‚: 1%é‡‡æ ·
  - æ…¢è¯·æ±‚(>2s): 100%é‡‡æ ·
å­˜å‚¨: Elasticsearch / Cassandra
```

### 5.2 æ€§èƒ½ç›‘æ§æ ‡å‡†

#### 5.2.1 å…³é”®æ€§èƒ½æŒ‡æ ‡(KPI)

```yaml
ç³»ç»Ÿå±‚é¢æŒ‡æ ‡:
  - CPUä½¿ç”¨ç‡: <70%
  - å†…å­˜ä½¿ç”¨ç‡: <80%  
  - ç£ç›˜ä½¿ç”¨ç‡: <85%
  - ç½‘ç»œå»¶è¿Ÿ: <50ms

åº”ç”¨å±‚é¢æŒ‡æ ‡:
  - APIå“åº”æ—¶é—´: P95 < 2s
  - ååé‡: >1000 TPS
  - é”™è¯¯ç‡: <0.1%
  - ç³»ç»Ÿå¯ç”¨æ€§: >99.9%

Agentå±‚é¢æŒ‡æ ‡:
  - ä»»åŠ¡å®Œæˆç‡: >95%
  - å¹³å‡ä»»åŠ¡æ‰§è¡Œæ—¶é—´: <30s
  - Agentå“åº”æ—¶é—´: <1s
  - èµ„æºåˆ©ç”¨ç‡: 60-80%
```

#### 5.2.2 å‘Šè­¦è§„åˆ™é…ç½®

```yaml
# prometheuså‘Šè­¦è§„åˆ™ç¤ºä¾‹
groups:
  - name: system_alerts
    rules:
      - alert: HighCPUUsage
        expr: cpu_usage_percent > 80
        for: 5m
        labels:
          severity: warning
        annotations:
          summary: "CPUä½¿ç”¨ç‡è¿‡é«˜"
          
      - alert: AgentTaskFailure
        expr: agent_task_failure_rate > 0.05
        for: 2m
        labels:
          severity: critical
        annotations:
          summary: "Agentä»»åŠ¡å¤±è´¥ç‡è¿‡é«˜"
```

---

## ğŸš€ éƒ¨ç½²ä¸è¿ç»´

### 6.1 å®¹å™¨åŒ–æŠ€æœ¯è¦æ±‚

#### 6.1.1 Dockeræ ‡å‡†

```dockerfile
# Dockerfileæ ‡å‡†æ¨¡æ¿
FROM python:3.11-slim

# æ ‡å‡†åŒ–æ ‡ç­¾
LABEL maintainer="team@company.com"
LABEL version="1.0.0"
LABEL description="Digital Employee Agent"

# ç³»ç»Ÿä¾èµ–
RUN apt-get update && apt-get install -y \
    gcc \
    g++ \
    && rm -rf /var/lib/apt/lists/*

# Pythonä¾èµ–
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

# åº”ç”¨ä»£ç 
WORKDIR /app
COPY . .

# å®‰å…¨æ€§ï¼šérootç”¨æˆ·
RUN useradd -m -u 1000 appuser
RUN chown -R appuser:appuser /app
USER appuser

# å¥åº·æ£€æŸ¥
HEALTHCHECK --interval=30s --timeout=3s --start-period=5s --retries=3 \
  CMD curl -f http://localhost:8000/health || exit 1

# å¯åŠ¨å‘½ä»¤
CMD ["uvicorn", "main:app", "--host", "0.0.0.0", "--port", "8000"]
```

#### 6.1.2 Kuberneteséƒ¨ç½²è§„èŒƒ

```yaml
# k8séƒ¨ç½²æ ‡å‡†æ¨¡æ¿
apiVersion: apps/v1
kind: Deployment
metadata:
  name: digital-employee-agent
  labels:
    app: digital-employee
    component: agent
    version: v1.0.0
spec:
  replicas: 3
  selector:
    matchLabels:
      app: digital-employee
      component: agent
  template:
    metadata:
      labels:
        app: digital-employee
        component: agent
    spec:
      containers:
      - name: agent
        image: digital-employee/agent:v1.0.0
        ports:
        - containerPort: 8000
        env:
        - name: DATABASE_URL
          valueFrom:
            secretKeyRef:
              name: db-secret
              key: url
        resources:
          requests:
            memory: "256Mi"
            cpu: "250m"
          limits:
            memory: "512Mi" 
            cpu: "500m"
        livenessProbe:
          httpGet:
            path: /health
            port: 8000
          initialDelaySeconds: 30
          periodSeconds: 10
        readinessProbe:
          httpGet:
            path: /ready
            port: 8000
          initialDelaySeconds: 5
          periodSeconds: 5
```

### 6.2 CI/CDæµæ°´çº¿

#### 6.2.1 GitLab CIæ ‡å‡†æµæ°´çº¿

```yaml
# .gitlab-ci.yml
stages:
  - test
  - build
  - security
  - deploy

variables:
  DOCKER_REGISTRY: "registry.company.com"
  IMAGE_NAME: "digital-employee/agent"

# ä»£ç è´¨é‡æ£€æŸ¥
code_quality:
  stage: test
  script:
    - pip install flake8 black mypy
    - black --check .
    - flake8 .
    - mypy .
  rules:
    - if: $CI_MERGE_REQUEST_ID

# å•å…ƒæµ‹è¯•
unit_tests:
  stage: test
  script:
    - pip install -r requirements-test.txt
    - pytest --cov=src --cov-report=xml
    - coverage report --fail-under=80
  coverage: '/TOTAL.*\s+(\d+%)$/'
  artifacts:
    reports:
      coverage_report:
        coverage_format: cobertura
        path: coverage.xml

# æ„å»ºé•œåƒ
build_image:
  stage: build
  script:
    - docker build -t $IMAGE_NAME:${CI_COMMIT_SHA} .
    - docker push $IMAGE_NAME:${CI_COMMIT_SHA}
  rules:
    - if: $CI_COMMIT_BRANCH == "main"

# å®‰å…¨æ‰«æ
security_scan:
  stage: security
  script:
    - trivy image --exit-code 1 --severity HIGH,CRITICAL $IMAGE_NAME:${CI_COMMIT_SHA}
  rules:
    - if: $CI_COMMIT_BRANCH == "main"

# éƒ¨ç½²åˆ°ç”Ÿäº§
deploy_production:
  stage: deploy
  script:
    - kubectl set image deployment/agent agent=$IMAGE_NAME:${CI_COMMIT_SHA}
    - kubectl rollout status deployment/agent
  environment:
    name: production
  rules:
    - if: $CI_COMMIT_BRANCH == "main"
      when: manual
```

---

## ğŸ“‹ ä»£ç è´¨é‡è¦æ±‚

### 7.1 ä»£ç è§„èŒƒæ ‡å‡†

#### 7.1.1 Pythonä»£ç è§„èŒƒ

```yaml
ä»£ç é£æ ¼:
  formatter: black
  line_length: 88
  import_sorting: isort
  
ç±»å‹æ£€æŸ¥:
  tool: mypy
  strict_mode: true
  disallow_untyped_defs: true
  
ä»£ç æ£€æŸ¥:
  tool: flake8 + pylint
  max_complexity: 10
  max_line_length: 88
  
æ–‡æ¡£è§„èŒƒ:
  docstring_style: Google Style
  coverage_requirement: 100% (å…¬å…±API)
```

#### 7.1.2 ä»£ç è´¨é‡é—¨ç¦

```python
# pre-commité’©å­é…ç½®
repos:
  - repo: https://github.com/psf/black
    rev: 22.10.0
    hooks:
      - id: black
        language_version: python3.11

  - repo: https://github.com/pycqa/isort
    rev: 5.10.1
    hooks:
      - id: isort
        args: ["--profile", "black"]

  - repo: https://github.com/pycqa/flake8
    rev: 5.0.4
    hooks:
      - id: flake8
        additional_dependencies: [flake8-docstrings]

  - repo: https://github.com/pre-commit/mirrors-mypy
    rev: v0.991
    hooks:
      - id: mypy
        additional_dependencies: [types-all]
```

### 7.2 æµ‹è¯•æ ‡å‡†

#### 7.2.1 æµ‹è¯•ç­–ç•¥

```mermaid
pyramid
    title æµ‹è¯•é‡‘å­—å¡”
    section ç«¯åˆ°ç«¯æµ‹è¯•
        E2E Tests : 5%
    section é›†æˆæµ‹è¯•  
        Integration Tests : 15%
    section å•å…ƒæµ‹è¯•
        Unit Tests : 80%
```

#### 7.2.2 æµ‹è¯•è¦†ç›–ç‡è¦æ±‚

| æ¨¡å—ç±»å‹ | è¦†ç›–ç‡è¦æ±‚ | æµ‹è¯•ç±»å‹ |
|----------|------------|----------|
| **æ ¸å¿ƒä¸šåŠ¡é€»è¾‘** | â‰¥95% | å•å…ƒæµ‹è¯• + é›†æˆæµ‹è¯• |
| **APIæ¥å£** | â‰¥90% | æ¥å£æµ‹è¯• + å•å…ƒæµ‹è¯• |
| **æ•°æ®è®¿é—®å±‚** | â‰¥85% | å•å…ƒæµ‹è¯• + æ•°æ®åº“æµ‹è¯• |
| **å·¥å…·ç±»/å¸®åŠ©ç±»** | â‰¥80% | å•å…ƒæµ‹è¯• |
| **é…ç½®/å¸¸é‡** | â‰¥60% | å•å…ƒæµ‹è¯• |

#### 7.2.3 æµ‹è¯•ä»£ç æ ‡å‡†

```python
# å•å…ƒæµ‹è¯•æ ‡å‡†æ¨¡æ¿
import pytest
from unittest.mock import Mock, patch
from src.agents.base_agent import BaseAgent

class TestBaseAgent:
    """BaseAgentå•å…ƒæµ‹è¯•ç±»"""
    
    @pytest.fixture
    def agent_config(self):
        """æµ‹è¯•é…ç½®fixture"""
        return AgentConfig(
            agent_id="test_agent",
            agent_type="test",
            version="1.0.0",
            capabilities=["test_capability"]
        )
    
    @pytest.fixture
    def mock_agent(self, agent_config):
        """Mock Agent fixture"""
        return BaseAgent(agent_config)
    
    async def test_execute_task_success(self, mock_agent):
        """æµ‹è¯•ä»»åŠ¡æ‰§è¡ŒæˆåŠŸåœºæ™¯"""
        # Given
        task = Task(task_id="test", task_type="test", data={})
        
        # When  
        result = await mock_agent.execute_task(task)
        
        # Then
        assert result.status == TaskStatus.COMPLETED
        assert result.task_id == "test"
    
    async def test_execute_task_failure(self, mock_agent):
        """æµ‹è¯•ä»»åŠ¡æ‰§è¡Œå¤±è´¥åœºæ™¯"""
        # Given
        task = Task(task_id="test", task_type="invalid", data={})
        
        # When & Then
        with pytest.raises(ValueError):
            await mock_agent.execute_task(task)
    
    @patch('src.agents.base_agent.MonitoringService')
    async def test_monitoring_integration(self, mock_monitoring, mock_agent):
        """æµ‹è¯•ç›‘æ§é›†æˆ"""
        # Given
        task = Task(task_id="test", task_type="test", data={})
        
        # When
        await mock_agent.execute_task(task)
        
        # Then
        mock_monitoring.record_task_execution.assert_called_once()
```

---

## ğŸ“š æŠ€æœ¯æ–‡æ¡£è¦æ±‚

### 8.1 æ–‡æ¡£æ ‡å‡†

#### 8.1.1 APIæ–‡æ¡£è§„èŒƒ

```yaml
APIæ–‡æ¡£æ ‡å‡†:
  æ ¼å¼: OpenAPI 3.0.3
  å·¥å…·: FastAPIè‡ªåŠ¨ç”Ÿæˆ + Swagger UI
  å¿…éœ€å†…å®¹:
    - æ¥å£æè¿°
    - è¯·æ±‚å‚æ•°è¯´æ˜
    - å“åº”æ ¼å¼å®šä¹‰
    - é”™è¯¯ç è¯´æ˜
    - ç¤ºä¾‹è¯·æ±‚/å“åº”
    - è®¤è¯æ–¹å¼è¯´æ˜
```

#### 8.1.2 ä»£ç æ–‡æ¡£è§„èŒƒ

```python
class AgentManager:
    """Agentç®¡ç†å™¨
    
    è´Ÿè´£Agentçš„ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼ŒåŒ…æ‹¬åˆ›å»ºã€é”€æ¯ã€ç›‘æ§ç­‰åŠŸèƒ½ã€‚
    
    Attributes:
        agents: å½“å‰æ´»è·ƒçš„Agentå®ä¾‹å­—å…¸
        config: Agentç®¡ç†å™¨é…ç½®
        
    Example:
        >>> manager = AgentManager(config)
        >>> agent = await manager.create_agent("hr_agent", agent_config)
        >>> await manager.destroy_agent(agent.agent_id)
    """
    
    def __init__(self, config: AgentManagerConfig):
        """åˆå§‹åŒ–Agentç®¡ç†å™¨
        
        Args:
            config: Agentç®¡ç†å™¨é…ç½®å¯¹è±¡
            
        Raises:
            ValueError: å½“é…ç½®æ— æ•ˆæ—¶æŠ›å‡º
        """
        pass
    
    async def create_agent(self, agent_type: str, config: Dict[str, Any]) -> BaseAgent:
        """åˆ›å»ºæ–°çš„Agentå®ä¾‹
        
        Args:
            agent_type: Agentç±»å‹ï¼Œå¦‚ 'hr_agent', 'finance_agent'
            config: Agenté…ç½®å­—å…¸
            
        Returns:
            åˆ›å»ºçš„Agentå®ä¾‹
            
        Raises:
            AgentCreationError: å½“Agentåˆ›å»ºå¤±è´¥æ—¶æŠ›å‡º
            ConfigurationError: å½“é…ç½®æ— æ•ˆæ—¶æŠ›å‡º
            
        Example:
            >>> config = {"max_tasks": 10, "timeout": 300}
            >>> agent = await manager.create_agent("hr_agent", config)
        """
        pass
```

### 8.2 æ¶æ„æ–‡æ¡£è¦æ±‚

#### 8.2.1 æ¶æ„å†³ç­–è®°å½•(ADR)æ¨¡æ¿

```markdown
# ADR-001: é€‰æ‹©FastAPIä½œä¸ºWebæ¡†æ¶

## çŠ¶æ€
å·²æ¥å—

## èƒŒæ™¯
éœ€è¦é€‰æ‹©Python Webæ¡†æ¶æ¥æ„å»ºAgentç®¡ç†APIã€‚

## å†³ç­–
é€‰æ‹©FastAPIä½œä¸ºä¸»è¦Webæ¡†æ¶ã€‚

## ç†ç”±
1. é«˜æ€§èƒ½ï¼šåŸºäºStarletteå’ŒPydanticï¼Œæ€§èƒ½ä¼˜å¼‚
2. ç±»å‹å®‰å…¨ï¼šåŸç”Ÿæ”¯æŒç±»å‹æ³¨è§£å’ŒéªŒè¯
3. è‡ªåŠ¨æ–‡æ¡£ï¼šè‡ªåŠ¨ç”ŸæˆOpenAPIæ–‡æ¡£
4. å¼‚æ­¥æ”¯æŒï¼šåŸç”Ÿasync/awaitæ”¯æŒ
5. ç”Ÿæ€ä¸°å¯Œï¼šä¸°å¯Œçš„æ’ä»¶å’Œæ‰©å±•

## åæœ
- æ­£é¢ï¼šå¼€å‘æ•ˆç‡é«˜ï¼Œæ–‡æ¡£è‡ªåŠ¨åŒ–ï¼Œæ€§èƒ½ä¼˜å¼‚
- è´Ÿé¢ï¼šç›¸å¯¹è¾ƒæ–°ï¼ŒæŸäº›åŠŸèƒ½å¯èƒ½ä¸å¦‚Djangoæˆç†Ÿ
- ä¸­æ€§ï¼šéœ€è¦å›¢é˜Ÿå­¦ä¹ æ–°æ¡†æ¶

## æ›¿ä»£æ–¹æ¡ˆ
- Django REST Framework: åŠŸèƒ½å…¨é¢ä½†æ€§èƒ½è¾ƒä½
- Flask: è½»é‡ä½†éœ€è¦æ›´å¤šé…ç½®
```

---

## ğŸ”§ å¼€å‘å·¥å…·é“¾

### 9.1 å¼€å‘ç¯å¢ƒè¦æ±‚

#### 9.1.1 æœ¬åœ°å¼€å‘ç¯å¢ƒ

```yaml
Pythonç¯å¢ƒ:
  ç‰ˆæœ¬: Python 3.11+
  åŒ…ç®¡ç†: poetry / pip-tools
  è™šæ‹Ÿç¯å¢ƒ: venv / conda
  
IDEé…ç½®:
  æ¨è: VS Code / PyCharm
  æ’ä»¶: Python, Pylance, GitLens, Docker
  é…ç½®: .vscode/settings.jsonç»Ÿä¸€é…ç½®
  
å¼€å‘å·¥å…·:
  ä»£ç æ ¼å¼åŒ–: black, isort
  ä»£ç æ£€æŸ¥: flake8, pylint, mypy
  æµ‹è¯•å·¥å…·: pytest, coverage
  è°ƒè¯•å·¥å…·: pdb, pytest-xvs
```

#### 9.1.2 é¡¹ç›®ç»“æ„æ ‡å‡†

```
digital_employee_system/
â”œâ”€â”€ src/                          # æºä»£ç ç›®å½•
â”‚   â”œâ”€â”€ agents/                   # Agentæ¨¡å—
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ base_agent.py        # AgentåŸºç¡€ç±»
â”‚   â”‚   â”œâ”€â”€ hr_agent.py          # HR Agent
â”‚   â”‚   â””â”€â”€ coding_agent.py      # Coding Agent
â”‚   â”œâ”€â”€ governance/               # æ²»ç†æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ registry.py          # Agentæ³¨å†Œ
â”‚   â”‚   â””â”€â”€ lifecycle.py         # ç”Ÿå‘½å‘¨æœŸç®¡ç†
â”‚   â”œâ”€â”€ prompt/                   # Promptç®¡ç†
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ manager.py           # Promptç®¡ç†å™¨
â”‚   â”‚   â””â”€â”€ templates/           # Promptæ¨¡æ¿
â”‚   â””â”€â”€ monitoring/               # ç›‘æ§æ¨¡å—
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ metrics.py           # æŒ‡æ ‡æ”¶é›†
â”‚       â””â”€â”€ health.py            # å¥åº·æ£€æŸ¥
â”œâ”€â”€ tests/                        # æµ‹è¯•ä»£ç 
â”‚   â”œâ”€â”€ unit/                    # å•å…ƒæµ‹è¯•
â”‚   â”œâ”€â”€ integration/             # é›†æˆæµ‹è¯•
â”‚   â””â”€â”€ e2e/                     # ç«¯åˆ°ç«¯æµ‹è¯•
â”œâ”€â”€ docs/                         # æ–‡æ¡£ç›®å½•
â”‚   â”œâ”€â”€ api/                     # APIæ–‡æ¡£
â”‚   â”œâ”€â”€ architecture/            # æ¶æ„æ–‡æ¡£
â”‚   â””â”€â”€ user_guide/              # ç”¨æˆ·æŒ‡å—
â”œâ”€â”€ deployment/                   # éƒ¨ç½²ç›¸å…³
â”‚   â”œâ”€â”€ docker/                  # Dockeræ–‡ä»¶
â”‚   â”œâ”€â”€ k8s/                     # Kubernetesé…ç½®
â”‚   â””â”€â”€ scripts/                 # éƒ¨ç½²è„šæœ¬
â”œâ”€â”€ config/                       # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ development.yaml         # å¼€å‘ç¯å¢ƒé…ç½®
â”‚   â”œâ”€â”€ production.yaml          # ç”Ÿäº§ç¯å¢ƒé…ç½®
â”‚   â””â”€â”€ test.yaml               # æµ‹è¯•ç¯å¢ƒé…ç½®
â”œâ”€â”€ requirements/                 # ä¾èµ–æ–‡ä»¶
â”‚   â”œâ”€â”€ base.txt                # åŸºç¡€ä¾èµ–
â”‚   â”œâ”€â”€ development.txt         # å¼€å‘ä¾èµ–
â”‚   â””â”€â”€ production.txt          # ç”Ÿäº§ä¾èµ–
â”œâ”€â”€ .github/                      # GitHub Actions
â”œâ”€â”€ .gitlab-ci.yml               # GitLab CIé…ç½®
â”œâ”€â”€ pyproject.toml               # Pythoné¡¹ç›®é…ç½®
â”œâ”€â”€ docker-compose.yml           # æœ¬åœ°å¼€å‘ç¯å¢ƒ
â””â”€â”€ README.md                    # é¡¹ç›®è¯´æ˜
```

### 9.2 ç‰ˆæœ¬ç®¡ç†è§„èŒƒ

#### 9.2.1 Gitå·¥ä½œæµ

```mermaid
gitgraph
    commit id: "Initial"
    branch develop
    checkout develop
    commit id: "Feature base"
    branch feature/agent-governance
    checkout feature/agent-governance
    commit id: "Add governance"
    commit id: "Add tests"
    checkout develop
    merge feature/agent-governance
    commit id: "Integration"
    branch release/v2.0.0
    checkout release/v2.0.0
    commit id: "Prepare release"
    checkout main
    merge release/v2.0.0 tag: "v2.0.0"
    checkout develop
    merge main
```

#### 9.2.2 æäº¤ä¿¡æ¯è§„èŒƒ

```bash
# æäº¤ä¿¡æ¯æ ¼å¼
<type>(<scope>): <subject>

<body>

<footer>

# ç¤ºä¾‹
feat(agent): add unified prompt management

- Implement UnifiedPromptManager class
- Add prompt template validation
- Support multi-version prompt management

Closes #123
```

---

## ğŸ“‹ æŠ€æœ¯å€ºåŠ¡ç®¡ç†

### 10.1 æŠ€æœ¯å€ºåŠ¡è¯†åˆ«

#### 10.1.1 å€ºåŠ¡ç±»å‹åˆ†ç±»

| å€ºåŠ¡ç±»å‹ | ä¸¥é‡ç¨‹åº¦ | å½±å“èŒƒå›´ | å¤„ç†ç­–ç•¥ |
|----------|----------|----------|----------|
| **æ¶æ„å€ºåŠ¡** | é«˜ | ç³»ç»Ÿçº§ | ä¼˜å…ˆé‡æ„ |
| **ä»£ç å€ºåŠ¡** | ä¸­ | æ¨¡å—çº§ | è¿­ä»£æ”¹è¿› |
| **æµ‹è¯•å€ºåŠ¡** | ä¸­ | è´¨é‡ä¿éšœ | è¡¥å……æµ‹è¯• |
| **æ–‡æ¡£å€ºåŠ¡** | ä½ | ç»´æŠ¤æ•ˆç‡ | å®šæœŸæ›´æ–° |

#### 10.1.2 æŠ€æœ¯å€ºåŠ¡åº¦é‡

```python
class TechnicalDebtMetrics:
    """æŠ€æœ¯å€ºåŠ¡åº¦é‡å·¥å…·"""
    
    def calculate_code_quality_score(self, project_path: str) -> float:
        """è®¡ç®—ä»£ç è´¨é‡åˆ†æ•°"""
        metrics = {
            'complexity': self._calculate_complexity(project_path),
            'duplication': self._calculate_duplication(project_path), 
            'coverage': self._calculate_test_coverage(project_path),
            'maintainability': self._calculate_maintainability(project_path)
        }
        
        # åŠ æƒè®¡ç®—æ€»åˆ†
        weights = {'complexity': 0.3, 'duplication': 0.2, 'coverage': 0.3, 'maintainability': 0.2}
        total_score = sum(metrics[key] * weights[key] for key in weights)
        
        return total_score
```

---

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–è¦æ±‚

### 11.1 æ€§èƒ½åŸºå‡†

#### 11.1.1 å“åº”æ—¶é—´è¦æ±‚

| æ“ä½œç±»å‹ | å“åº”æ—¶é—´ç›®æ ‡ | æœ€å¤§å¯æ¥å—æ—¶é—´ |
|----------|--------------|----------------|
| **AgentçŠ¶æ€æŸ¥è¯¢** | <100ms | <500ms |
| **ç®€å•ä»»åŠ¡æ‰§è¡Œ** | <2s | <5s |
| **å¤æ‚ä»»åŠ¡æ‰§è¡Œ** | <30s | <60s |
| **æ‰¹é‡æ“ä½œ** | <10s | <30s |

#### 11.1.2 å¹¶å‘æ€§èƒ½è¦æ±‚

```yaml
å¹¶å‘æŒ‡æ ‡:
  åŒæ—¶åœ¨çº¿ç”¨æˆ·: 1000+
  å¹¶å‘è¯·æ±‚æ•°: 500 TPS
  Agentå¹¶å‘ä»»åŠ¡: 100ä¸ª/Agent
  ç³»ç»Ÿæ€»å¹¶å‘ä»»åŠ¡: 10000+
  
èµ„æºé™åˆ¶:
  å•Agentå†…å­˜: <512MB
  å•Agent CPU: <0.5 core
  æ•°æ®åº“è¿æ¥æ± : 100è¿æ¥
  Redisè¿æ¥æ± : 50è¿æ¥
```

### 11.2 æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

#### 11.2.1 å¼‚æ­¥å¤„ç†ä¼˜åŒ–

```python
# å¼‚æ­¥ä»»åŠ¡å¤„ç†ç¤ºä¾‹
class TaskProcessor:
    """å¼‚æ­¥ä»»åŠ¡å¤„ç†å™¨"""
    
    def __init__(self, max_workers: int = 10):
        self.semaphore = asyncio.Semaphore(max_workers)
        self.task_queue = asyncio.Queue()
        
    async def process_tasks(self):
        """å¤„ç†ä»»åŠ¡é˜Ÿåˆ—"""
        while True:
            task = await self.task_queue.get()
            asyncio.create_task(self._process_single_task(task))
            
    async def _process_single_task(self, task):
        """å¤„ç†å•ä¸ªä»»åŠ¡"""
        async with self.semaphore:
            try:
                result = await self._execute_task(task)
                await self._save_result(result)
            except Exception as e:
                await self._handle_error(task, e)
            finally:
                self.task_queue.task_done()
```

---

## ğŸ”„ ç‰ˆæœ¬ç®¡ç†ä¸å‘å¸ƒ

### 12.1 ç‰ˆæœ¬å·è§„èŒƒ

#### 12.1.1 è¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶

```yaml
ç‰ˆæœ¬æ ¼å¼: MAJOR.MINOR.PATCH[-PRERELEASE][+BUILD]

ç‰ˆæœ¬é€’å¢è§„åˆ™:
  MAJOR: ä¸å…¼å®¹çš„APIä¿®æ”¹
  MINOR: å‘åå…¼å®¹çš„åŠŸèƒ½æ€§æ–°å¢
  PATCH: å‘åå…¼å®¹çš„é—®é¢˜ä¿®æ­£
  PRERELEASE: é¢„å‘å¸ƒç‰ˆæœ¬æ ‡è¯†
  BUILD: ç‰ˆæœ¬å…ƒæ•°æ®

ç¤ºä¾‹:
  - 1.0.0: é¦–ä¸ªæ­£å¼ç‰ˆæœ¬
  - 1.1.0: æ–°å¢åŠŸèƒ½
  - 1.1.1: ä¿®å¤bug
  - 2.0.0-alpha.1: å¤§ç‰ˆæœ¬é¢„å‘å¸ƒ
  - 2.0.0+20240124: å¸¦æ„å»ºä¿¡æ¯
```

#### 12.1.2 å‘å¸ƒæµç¨‹

```mermaid
graph LR
    A[å¼€å‘å®Œæˆ] --> B[ä»£ç æäº¤]
    B --> C[CI/CDæ£€æŸ¥]
    C --> D[åˆ›å»ºå‘å¸ƒåˆ†æ”¯]
    D --> E[ç‰ˆæœ¬æ ‡è®°]
    E --> F[æ„å»ºå‘å¸ƒåŒ…]
    F --> G[éƒ¨ç½²æµ‹è¯•ç¯å¢ƒ]
    G --> H[éªŒæ”¶æµ‹è¯•]
    H --> I[éƒ¨ç½²ç”Ÿäº§ç¯å¢ƒ]
    I --> J[å‘å¸ƒå®Œæˆ]
```

---

**æ–‡æ¡£çŠ¶æ€**: æ­£å¼å‘å¸ƒ  
**æœ€åæ›´æ–°**: 2024-01-24  
**ä¸‹æ¬¡è¯„å®¡**: 2024-03-24  
**æ‰¹å‡†äºº**: æŠ€æœ¯æ¶æ„å§”å‘˜ä¼š